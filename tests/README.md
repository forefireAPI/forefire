
# *FireFront* Test Suite

This directory contains **five** sets of tests that showcase the different interfaces and use-cases of *ForeFire*.

| Folder / script | Purpose of the test | Specific dependencies |
| --------------- | ------------------ | --------------------- |
| `mnh_ideal` | *ForeFire* / **Meso-NH** coupling on an idealised atmospheric case | `SRC_MESONH` must be set; Meso-NH compiled with the *ForeFire* library placed in its `exe` directory |
| `mnh_real_nested` | *ForeFire* / **Meso-NH** coupling on a real nested case | Same requirements as above |
| `python` | Usage examples via the Python API:<br>• `idealized_wind.py` (360° rotating wind)<br>• `percolation.py` (propagation through fuels of random density) | Python bindings must be set and PYTHONEXE set to the python eneble binary |
| `runANN` | Activation of a serialised ANN graph (`rothermel.fann`) that reproduces the Rothermel model | `tensorflow` (or `torch` if a PyTorch graph is supplied) |
| `runff` | Using the *ForeFire* command-line interpreter to:<br>1. launch a real simulation;<br>2. save/load a state;<br>3. convert outputs (FF, KML, GeoJSON) | *ForeFire* only |

---

## 1. General prerequisites

* **ForeFire** compiled and available in the `bin` dir.

* *(optional)* **Meso-NH** – required only for the `mnh_*` tests.  
```bash
  export SRC_MESONH=/path/to/your/mesonh
```

* *(optional)* **Python bindings** – required for the `python` folder 

```bash
  export PYTHONEXE=/path/to/your/python_forefire_enabled
```

---

## 2. Running the tests

```bash
   make test
```

---

## 3. Cleaning up

```bash
make clean
```

Removes intermediate files (ForeFire outputs, figures, NetCDF files, …) generated by all tests.

---

## 4. Test set details

### 4.1 `mnh_ideal`

* **Goal** – validate the coupling on a simplified atmospheric profile.
* **Expected outcome** – a fire front consistent with the prescribed wind, plus NetCDF and KML outputs.

### 4.2 `mnh_real_nested`

* **Goal** – reproduce a real fire scenario with nested Meso-NH domains.
* **Features**

  * two domains (real forcing + high-resolution nest);
  * performance and stability check.
  * high frequency outputs and http web interface (requires FOREFIREHOME environment variable set)
  

### 4.3 `python`

| Script              | Description                                                          | Expected artefacts          |
| ------------------- | -------------------------------------------------------------------- | --------------------------- |
| `idealized_wind.py` | Wind rotating from 0° to 360°; circular fire front (regression test) | `360wind.png`, NetCDF files |
| `percolation.py`    | Three fires propagating through randomly heterogeneous fuels         | `percolation.nc`            |

### 4.4 `runANN`

* **Goal** – verify *ForeFire*’s internal feed-forward routine on an ANN graph trained to approximate the Rothermel formula.
* **Steps**

  1. Load `rothermel.fann`.
  2. Activate on various *fuel / slope / wind* combinations.
  3. Compare with reference outputs.

### 4.5 `runff`
* **Goal** – verify *ForeFire*’s command line intrerpreter.

Three successive scenarios:

1. **`realcase.ff`** – start a real case, save the state in FF format.
2. **`reload_case.ff`**  Reload the state and export KML.
3. **`rungeojson.ff`**  Single-run variant – load ► simulate ► export GeoJSON, clear memory, reload GeoJSON for verification.

---
